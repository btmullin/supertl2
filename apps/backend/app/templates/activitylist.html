{% extends 'base.html' %} {% block content %}
<div class="whole-body">
  <div class="section">
    <form method="get" style="margin-bottom: 0.75rem;">
      <label class="filter-checkbox">
        <input type="checkbox"
              name="missing_training_log"
              value="1"
              {% if missing_training_log %}checked{% endif %}>
        <span>Only show activities missing a training log</span>
      </label>
      <input type="submit" value="Apply" style="margin-left: 0.6rem;">
    </form>
    <table class="styled-table">
      <thead>
        <tr>
          <th>Date/Time</th>
          <th>Sport</th>
          <th>Name</th>
          <th>Distance</th>
          <th>Time</th>
          <th>Training Log</th>
          <th>Is Training?</th>
          <th>Source</th>
        </tr>
      </thead>
      {% for activity, training_log in activities %}
        <tr onclick="window.location='{{ url_for('views.edit_activity', id=activity.id, next=request.full_path) }}'" style="cursor: pointer;">
          <td class="col-date-time">{{ activity.start_time_utc | localtime | pretty_datetime }}</td>
          <td class="col-sport">{{ activity.sport }}</td>
          <td class="col-name">{{ activity.name }}</td>
          <td class="col-distance">{{ activity.distance_m | km }}</td>
          <td class="col-time">{{ activity.moving_time_s | format_duration }}</td>
          <td class="col-extra">{% if training_log and training_log.canonical_activity_id %}✅{% else %}❌{% endif %}</td>
          <td class="col-training">
            {% if training_log is not none %}
              {% if training_log.isTraining == 1 %}
                ✅
              {% elif training_log.isTraining == 0 %}
                ❌
              {% else %}
                ❔
              {% endif %}
            {% else %}
              ❔
            {% endif %}
          </td>
          <td class="col-source">
            {% if activity.sources %}
              {% for src in activity.sources %}
                {% if src.source == 'strava' %}
                  STRAVA
                {% elif src.source == 'sporttracks' %}
                  ST
                {% else %}
                  {{ src.source|upper }}
                {% endif %}
                {% if not loop.last %}, {% endif %}
              {% endfor %}
            {% else %}
              ❔
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </table>
    <div class="pagination">
      {% if page > 1 %}
        <a href="{{ url_for('views.activitylist', page=page-1, missing_training_log=('1' if missing_training_log else '0')) }}">Previous</a>
      {% endif %}

      <span>Page {{ page }} of {{ total_pages }}</span>

      {% if page < total_pages %}
        <a href="{{ url_for('views.activitylist', page=page+1, missing_training_log=('1' if missing_training_log else '0')) }}">Next</a>
      {% endif %}
    </div>
</div>
{% endblock %}